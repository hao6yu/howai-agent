(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1429:function(e,t,s){Promise.resolve().then(s.bind(s,6839))},6839:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var a=s(7437),r=s(2265);let n=(0,s(1388).createBrowserClient)("https://yjxoreszkpdealtzyvyu.supabase.co","sb_publishable_NvluG8lAmJXglB0qQRwGRg_bPzYdvDP");function i(){let[e,t]=(0,r.useState)(null),[s,a]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{(async()=>{var e;let{data:{session:s}}=await n.auth.getSession();t(null!==(e=null==s?void 0:s.user)&&void 0!==e?e:null),a(!1)})();let{data:{subscription:e}}=n.auth.onAuthStateChange(async(e,s)=>{var r;t(null!==(r=null==s?void 0:s.user)&&void 0!==r?r:null),a(!1)});return()=>e.unsubscribe()},[]),{user:e,loading:s,signOut:async()=>{await n.auth.signOut()}}}function l(){let[e,t]=(0,r.useState)("sign-in"),[s,i]=(0,r.useState)(""),[l,o]=(0,r.useState)(""),[c,d]=(0,r.useState)(!1),[m,x]=(0,r.useState)(""),u=async t=>{t.preventDefault(),d(!0),x("");try{if("sign-up"===e){let{error:e}=await n.auth.signUp({email:s,password:l});if(e)throw e;x("Check your email for confirmation link!")}else{let{error:e}=await n.auth.signInWithPassword({email:s,password:l});if(e)throw e}}catch(e){x(e instanceof Error?e.message:"An error occurred")}finally{d(!1)}};return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsxs)("div",{className:"max-w-md w-full space-y-8 p-8 bg-white rounded-lg shadow-md",children:[(0,a.jsx)("div",{children:(0,a.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"sign-in"===e?"Sign in to HowAI":"Create your account"})}),(0,a.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:u,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),(0,a.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Enter your email",value:s,onChange:e=>i(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,a.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Enter your password",value:l,onChange:e=>o(e.target.value)})]}),m&&(0,a.jsx)("div",{className:"p-3 rounded-md text-sm ".concat(m.includes("error")||m.includes("Error")?"bg-red-100 text-red-700":"bg-green-100 text-green-700"),children:m}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"submit",disabled:c,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:c?"Loading...":"sign-in"===e?"Sign in":"Sign up"})}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("button",{type:"button",className:"text-indigo-600 hover:text-indigo-500",onClick:()=>t("sign-in"===e?"sign-up":"sign-in"),children:"sign-in"===e?"Don't have an account? Sign up":"Already have an account? Sign in"})})]})]})})}var o=s(3417),c=s(3247),d=s(6506),m=s(3720),x=s(8930),u=s(8728),g=s(4972),h=s(6980),p=s(2489),f=s(9397),y=s(4743);function v(e){let{message:t}=e;return t.is_ai?(0,a.jsx)("div",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"max-w-3xl",children:[(0,a.jsxs)("div",{className:"bg-white rounded-2xl px-4 py-3 shadow-sm",children:[(0,a.jsx)("p",{className:"text-gray-900 leading-relaxed whitespace-pre-wrap",children:t.content}),t.image_urls&&t.image_urls.length>0&&(0,a.jsx)("div",{className:"mt-3 space-y-2",children:t.image_urls.map((e,t)=>(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("img",{src:e,alt:"Generated image ".concat(t+1),className:"max-w-full h-auto rounded-lg shadow-sm cursor-pointer hover:shadow-md transition-shadow",onClick:()=>window.open(e,"_blank"),onError:t=>{console.error("Failed to load image:",e),t.currentTarget.style.display="none"}})},t))})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-2 ml-1",children:new Date(t.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})}):(0,a.jsx)("div",{className:"px-6 py-4",children:(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)("div",{className:"max-w-3xl",children:[(0,a.jsx)("div",{className:"bg-blue-500 text-white rounded-2xl px-4 py-3 shadow-sm",children:(0,a.jsx)("p",{className:"leading-relaxed whitespace-pre-wrap",children:t.content})}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-2 mr-1 text-right",children:new Date(t.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})})})}function b(){let{user:e}=i(),[t,l]=(0,r.useState)([]),[b,j]=(0,r.useState)(""),[w,N]=(0,r.useState)(!1),[D,C]=(0,r.useState)(null),[k,E]=(0,r.useState)([]),[S,_]=(0,r.useState)([]),[P,A]=(0,r.useState)(!1),[I,R]=(0,r.useState)(!1),[L,T]=(0,r.useState)([]),[Z,F]=(0,r.useState)([]),[z,H]=(0,r.useState)(!1),[O,q]=(0,r.useState)(!1),[W,U]=(0,r.useState)(0),[M,B]=(0,r.useState)(""),G=(0,r.useRef)(null),K=(0,r.useRef)(null),$=(0,r.useRef)(null),J=(0,r.useRef)(null),Y=(0,r.useRef)(null),Q=()=>{var e;null===(e=G.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},V=async e=>{try{let t=(await s.e(156).then(s.t.bind(s,9140,23))).default,a=await t({blob:e,toType:"image/jpeg",quality:.8});return new File([a],e.name.replace(/\.heic$/i,".jpg"),{type:"image/jpeg"})}catch(t){throw console.error("Error converting HEIC file:",t),Error("Failed to convert HEIC file: ".concat(e.name))}},X=async e=>{if(!e)return;let t=Array.from(e),s=[];for(let e of t){let t=["image/jpeg","image/jpg","image/png","image/gif","image/webp","image/heic","image/heif","application/pdf","text/plain","text/csv","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/javascript","text/html","text/css","application/json"],a=e.name.match(/\.(heic|heif)$/i),r=t.includes(e.type)||a,n=e.name.match(/\.(txt|md|js|ts|py|java|cpp|c|h)$/i);if(!r&&!n){alert("File type not supported: ".concat(e.name));continue}if(e.size>10485760){alert("File too large: ".concat(e.name," (max 10MB)"));continue}try{if(a){let t=await V(e);s.push(t)}else s.push(e)}catch(t){console.error("Error processing file:",t),alert("Error processing file: ".concat(e.name));continue}}s.length>0&&(T(e=>[...e,...s]),s.forEach(e=>{if(e.type.startsWith("image/")){let t=URL.createObjectURL(e);F(e=>[...e,t])}else F(e=>[...e,""])}))},ee=e=>{let t=L[e],s=Z[e];s&&t.type.startsWith("image/")&&URL.revokeObjectURL(s),T(t=>t.filter((t,s)=>s!==e)),F(t=>t.filter((t,s)=>s!==e))},et=e=>new Promise((t,s)=>{let a=new FileReader;a.readAsDataURL(e),a.onload=()=>{t(a.result.split(",")[1])},a.onerror=e=>s(e)});(0,r.useEffect)(()=>{Q()},[t]),(0,r.useEffect)(()=>{let e=e=>{J.current&&!J.current.contains(e.target)&&H(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,r.useEffect)(()=>{let e=e=>{e.preventDefault(),e.stopPropagation()},t=["dragenter","dragover","dragleave","drop"];return t.forEach(t=>{document.addEventListener(t,e,!1)}),()=>{t.forEach(t=>{document.removeEventListener(t,e,!1)})}},[]);let es=(0,r.useCallback)(async()=>{if(e)try{let{data:t,error:s}=await n.from("conversations").select("*").eq("user_id",e.id).order("updated_at",{ascending:!1});if(s){console.error("Error fetching conversations:",s);return}if(t){let e=t.filter(e=>e.is_pinned).sort((e,t)=>new Date(t.updated_at).getTime()-new Date(e.updated_at).getTime()),s=t.filter(e=>!e.is_pinned).sort((e,t)=>new Date(t.updated_at).getTime()-new Date(e.updated_at).getTime());_(e),E(s)}}catch(e){console.error("Error loading conversations:",e)}},[e]),ea=(0,r.useCallback)(async()=>{if(e)try{let{data:a,error:r}=await n.from("profiles").select("id").eq("id",e.id).single();if(r&&"PGRST116"===r.code){var t,s;console.log("Creating user profile...");let{error:a}=await n.from("profiles").insert({id:e.id,email:e.email,name:(null===(t=e.user_metadata)||void 0===t?void 0:t.name)||(null===(s=e.email)||void 0===s?void 0:s.split("@")[0])});if(a){console.error("Error creating profile:",a);return}}await es();let{data:i,error:l}=await n.from("conversations").select("*").eq("user_id",e.id).order("updated_at",{ascending:!1}).limit(1);if(l){console.error("Error fetching conversations:",l);return}let o=null==i?void 0:i[0];o||(o=await er()),o&&(console.log("Conversation loaded:",o.id),C(o),eo(o.id))}catch(e){console.error("Error in loadOrCreateConversation:",e)}},[e,es]),er=async()=>{if(!e)return null;try{let{data:t,error:s}=await n.from("conversations").insert({user_id:e.id,title:"New Chat"}).select().single();if(s)return console.error("Error creating conversation:",s),null;return await es(),t}catch(e){return console.error("Error creating new conversation:",e),null}},en=async e=>{C(e),eo(e.id)},ei=async e=>{try{let{error:t}=await n.from("conversations").update({is_pinned:!e.is_pinned}).eq("id",e.id);if(t){console.error("Error toggling pin:",t);return}await es()}catch(e){console.error("Error toggling pin:",e)}},el=async e=>{try{let{error:t}=await n.from("conversations").delete().eq("id",e.id);if(t){console.error("Error deleting conversation:",t);return}if((null==D?void 0:D.id)===e.id){let e=await er();e&&(C(e),l([]))}await es()}catch(e){console.error("Error deleting conversation:",e)}};(0,r.useEffect)(()=>{e&&ea()},[e,ea]);let eo=async e=>{let{data:t}=await n.from("messages").select("*").eq("conversation_id",e).order("created_at",{ascending:!0});t&&l(t)},ec=async()=>{if(console.log("Send message clicked",{hasMessage:!!b.trim(),hasConversation:!!D,hasUser:!!e,attachedFiles:L.length}),!b.trim()&&0===L.length||!D||!e){console.log("Send message aborted - missing requirements");return}N(!0);try{let e=[];for(let t=0;t<L.length;t++){let s=L[t];if(s.type.startsWith("image/")){let t=await et(s);e.push({type:"image",name:s.name,mimeType:s.type,data:t})}else{let t=await s.text();e.push({type:"document",name:s.name,mimeType:s.type,content:t.substring(0,1e4)})}}let s=b;if(L.length>0){let e=L.map(e=>"\uD83D\uDCCE ".concat(e.name)).join("\n");s=b?"".concat(b,"\n\n").concat(e):e}let a=[...e],{data:r}=await n.from("messages").insert({conversation_id:D.id,content:s,is_ai:!1}).select().single();r&&l(e=>[...e,r]),j(""),T([]),F([]);let i=0===t.length;try{let e=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:b,conversationId:D.id,deepResearch:P,attachments:a,generateTitle:i,allowWebSearch:I,enableAIWebSearchDetection:!I})});if(!e.ok)throw Error("Failed to get AI response");let t=await e.json();t.message&&l(e=>[...e,t.message]),t.title&&D&&(C(e=>e?{...e,title:t.title}:null),await es())}catch(t){console.error("Error calling chat API:",t);let e={id:"error-".concat(Date.now()),conversation_id:D.id,content:"Sorry, I encountered an error processing your message. Please try again.",is_ai:!0,created_at:new Date().toISOString()};l(t=>[...t,e])}finally{N(!1)}}catch(e){console.error("Error sending message:",e),N(!1)}},ed=async()=>{await n.auth.signOut()};if(!e)return(0,a.jsx)("div",{children:"Please sign in to use the chat."});let em=null==D?void 0:D.id;return(0,a.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,a.jsxs)("div",{className:"w-80 bg-white border-r border-gray-200 flex flex-col flex-shrink-0 hidden lg:flex",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 flex items-center justify-center",children:(0,a.jsx)("img",{src:"/howai-icon.png",alt:"HowAI",className:"w-8 h-8 rounded-lg"})}),(0,a.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"HowAI"})]}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsx)("button",{onClick:async()=>{let e=await er();e&&(C(e),l([]))},className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors",title:"New conversation",children:(0,a.jsx)(o.Z,{className:"w-5 h-5"})})})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(c.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,a.jsx)("input",{type:"text",placeholder:"Search conversations...",value:M,onChange:e=>B(e.target.value),className:"w-full pl-10 pr-4 py-2 text-sm bg-gray-50 border border-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[S.length>0&&(0,a.jsxs)("div",{className:"p-3",children:[(0,a.jsx)("h3",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-2 px-2",children:"Pinned"}),(0,a.jsx)("div",{className:"space-y-1",children:S.map(e=>(0,a.jsxs)("div",{className:"group flex items-center px-3 py-2 text-sm rounded-md cursor-pointer transition-colors ".concat(em===e.id?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-50"),onClick:()=>en(e),children:[(0,a.jsx)(d.Z,{className:"w-4 h-4 mr-2 text-yellow-500"}),(0,a.jsx)("span",{className:"flex-1 truncate",children:e.title}),(0,a.jsxs)("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),ei(e)},className:"p-1 text-gray-400 hover:text-gray-600 rounded",title:"Unpin",children:(0,a.jsx)(m.Z,{className:"w-3 h-3"})}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),el(e)},className:"p-1 text-gray-400 hover:text-red-500 rounded",title:"Delete",children:(0,a.jsx)(x.Z,{className:"w-3 h-3"})})]})]},e.id))})]}),(0,a.jsxs)("div",{className:"p-3",children:[S.length>0&&(0,a.jsx)("h3",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-2 px-2",children:"Recent"}),(0,a.jsx)("div",{className:"space-y-1",children:k.filter(e=>!e.is_pinned).map(e=>(0,a.jsxs)("div",{className:"group flex items-center px-3 py-2 text-sm rounded-md cursor-pointer transition-colors ".concat(em===e.id?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-50"),onClick:()=>en(e),children:[(0,a.jsx)(o.Z,{className:"w-4 h-4 mr-2 text-gray-400"}),(0,a.jsx)("span",{className:"flex-1 truncate",children:e.title}),(0,a.jsxs)("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),ei(e)},className:"p-1 text-gray-400 hover:text-yellow-500 rounded",title:"Pin",children:(0,a.jsx)(d.Z,{className:"w-3 h-3"})}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),el(e)},className:"p-1 text-gray-400 hover:text-red-500 rounded",title:"Delete",children:(0,a.jsx)(x.Z,{className:"w-3 h-3"})})]})]},e.id))})]})]}),(0,a.jsxs)("div",{className:"p-3 border-t border-gray-200",children:[(0,a.jsx)("div",{className:"text-xs text-gray-500 mb-2 px-3",children:null==e?void 0:e.email}),(0,a.jsxs)("button",{className:"w-full flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md transition-colors",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Settings"]}),(0,a.jsxs)("button",{onClick:ed,className:"w-full flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md transition-colors mt-1",children:[(0,a.jsx)("span",{className:"w-4 h-4 mr-2",children:"â†—"}),"Logout"]})]})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col relative",ref:Y,onDragEnter:e=>{e.preventDefault(),e.stopPropagation(),U(e=>e+1),e.dataTransfer.items&&e.dataTransfer.items.length>0&&q(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),U(e=>e-1),W<=1&&q(!1)},onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDrop:e=>{e.preventDefault(),e.stopPropagation(),q(!1),U(0);let t=e.dataTransfer.files;t&&t.length>0&&X(t)},children:[(0,a.jsx)("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center space-x-3",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:(null==D?void 0:D.title)||"New Conversation"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Your friendly AI assistant"})]})}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[P&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 bg-purple-50 px-3 py-1 rounded-full",children:[(0,a.jsx)(g.Z,{size:16,className:"text-purple-600"}),(0,a.jsx)("span",{className:"text-sm font-medium text-purple-700",children:"Deep Research"})]}),I&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 bg-blue-50 px-3 py-1 rounded-full",children:[(0,a.jsx)(c.Z,{size:16,className:"text-blue-600"}),(0,a.jsx)("span",{className:"text-sm font-medium text-blue-700",children:"Web Search"})]})]})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto",children:0===t.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center px-6",children:[(0,a.jsx)("div",{className:"w-16 h-16 flex items-center justify-center mb-4",children:(0,a.jsx)("img",{src:"/howai-icon.png",alt:"HowAI",className:"w-16 h-16 rounded-2xl"})}),(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"How can I help you today?"}),(0,a.jsx)("p",{className:"text-gray-600 mb-8 max-w-md",children:"I'm HowAI, your friendly AI assistant designed for kids. Ask me anything - from homework help to fun facts!"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 w-full max-w-2xl",children:[(0,a.jsx)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 hover:border-gray-300 cursor-pointer transition-colors",children:(0,a.jsx)("p",{className:"text-sm text-gray-700",children:"\uD83D\uDCDA Help with homework"})}),(0,a.jsx)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 hover:border-gray-300 cursor-pointer transition-colors",children:(0,a.jsx)("p",{className:"text-sm text-gray-700",children:"\uD83D\uDD2C Explain science concepts"})}),(0,a.jsx)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 hover:border-gray-300 cursor-pointer transition-colors",children:(0,a.jsx)("p",{className:"text-sm text-gray-700",children:"\uD83C\uDFA8 Creative writing ideas"})}),(0,a.jsx)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 hover:border-gray-300 cursor-pointer transition-colors",children:(0,a.jsx)("p",{className:"text-sm text-gray-700",children:"\uD83C\uDF1F Fun facts and trivia"})})]})]}):(0,a.jsxs)("div",{className:"py-6",children:[t.map(e=>(0,a.jsx)(v,{message:e},e.id)),w&&(0,a.jsx)("div",{className:"px-6 py-4",children:(0,a.jsx)("div",{className:"max-w-3xl",children:(0,a.jsx)("div",{className:"bg-white rounded-2xl px-4 py-3 shadow-sm",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),(0,a.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,a.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"Thinking..."})]})})})}),(0,a.jsx)("div",{ref:G})]})})}),(0,a.jsxs)("div",{className:"bg-white px-6 py-4 border-t border-gray-200 flex-shrink-0",children:[(0,a.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-gray-100 rounded-2xl p-3",children:[L.length>0&&(0,a.jsx)("div",{className:"mb-3 flex flex-wrap gap-2",children:L.map((e,t)=>(0,a.jsxs)("div",{className:"relative bg-white rounded-lg p-2 flex items-center space-x-2 max-w-xs",children:[e.type.startsWith("image/")&&Z[t]?(0,a.jsx)("img",{src:Z[t],alt:e.name,className:"w-8 h-8 object-cover rounded"}):(0,a.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded flex items-center justify-center",children:(0,a.jsx)(h.Z,{size:16,className:"text-gray-600"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[(e.size/1024).toFixed(1)," KB"]})]}),(0,a.jsx)("button",{onClick:()=>ee(t),className:"p-1 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:(0,a.jsx)(p.Z,{size:14})})]},t))}),(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsx)("textarea",{value:b,onChange:e=>j(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),ec())},placeholder:"Ask anything",className:"w-full bg-transparent resize-none focus:outline-none text-gray-900 placeholder-gray-500 text-base leading-6",rows:1,disabled:w,style:{minHeight:"24px",maxHeight:"200px"},onInput:e=>{let t=e.target;t.style.height="24px",t.style.height=Math.min(t.scrollHeight,200)+"px"}})}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("div",{className:"relative",ref:J,children:[(0,a.jsx)("button",{onClick:()=>{H(!z)},className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-200 rounded-lg transition-colors flex items-center justify-center",title:"Add attachments",children:(0,a.jsx)(f.Z,{size:18})}),z&&(0,a.jsxs)("div",{className:"absolute bottom-full left-0 mb-2 bg-white rounded-lg shadow-lg border border-gray-200 py-1 min-w-48",children:[(0,a.jsx)("button",{onClick:()=>{var e;null===(e=$.current)||void 0===e||e.click(),H(!1)},className:"w-full px-4 py-3 text-left text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"\uD83D\uDCF7 Upload photo"}),(0,a.jsx)("button",{onClick:()=>{var e;null===(e=K.current)||void 0===e||e.click(),H(!1)},className:"w-full px-4 py-3 text-left text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"\uD83D\uDCC4 Upload file"})]})]}),(0,a.jsx)("button",{onClick:()=>A(!P),className:"p-2 rounded-lg transition-colors flex items-center justify-center ".concat(P?"bg-purple-200 text-purple-700 hover:bg-purple-300":"text-gray-600 hover:text-purple-600 hover:bg-purple-100"),title:P?"Disable Deep Research Mode":"Enable Deep Research Mode",children:(0,a.jsx)(g.Z,{size:18})}),(0,a.jsx)("button",{onClick:()=>R(!I),className:"p-2 rounded-lg transition-colors flex items-center justify-center ".concat(I?"bg-blue-200 text-blue-700 hover:bg-blue-300":"text-gray-600 hover:text-blue-600 hover:bg-blue-100"),title:I?"Disable Web Search":"Enable Web Search",children:(0,a.jsx)(c.Z,{size:18})})]}),(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsxs)("button",{onClick:ec,disabled:w||!b.trim()&&0===L.length,className:"px-4 py-2 rounded-lg font-medium transition-colors flex items-center space-x-2 ".concat((b.trim()||L.length>0)&&!w?"bg-blue-500 text-white hover:bg-blue-600":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:[(0,a.jsx)(y.Z,{size:16}),(0,a.jsx)("span",{children:"Send"})]})})]})]})}),(0,a.jsx)("input",{ref:K,type:"file",multiple:!0,accept:".pdf,.txt,.csv,.doc,.docx,.xls,.xlsx,.js,.ts,.py,.java,.cpp,.c,.h,.md,.json,.html,.css",onChange:e=>X(e.target.files),className:"hidden"}),(0,a.jsx)("input",{ref:$,type:"file",multiple:!0,accept:"image/*,.heic,.heif",onChange:e=>X(e.target.files),className:"hidden"}),O&&(0,a.jsx)("div",{className:"fixed inset-0 bg-blue-500 bg-opacity-20 flex items-center justify-center z-50 pointer-events-none",children:(0,a.jsx)("div",{className:"bg-white rounded-2xl p-8 shadow-2xl border-2 border-dashed border-blue-500 max-w-md mx-4",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Drop files to upload"}),(0,a.jsx)("p",{className:"text-gray-600 text-sm",children:"Drop your photos or documents here to attach them to your message"})]})})})]})]})]})}function j(){let{user:e,loading:t}=i();return t?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-lg",children:"Loading..."})}):e?(0,a.jsx)("div",{className:"h-screen bg-gray-50",children:(0,a.jsx)(b,{})}):(0,a.jsx)(l,{})}}},function(e){e.O(0,[850,971,117,744],function(){return e(e.s=1429)}),_N_E=e.O()}]);