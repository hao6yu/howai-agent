"use strict";(()=>{var e={};e.id=562,e.ids=[562],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9224:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>c,patchFetch:()=>f,requestAsyncStorage:()=>d,routeModule:()=>l,serverHooks:()=>m,staticGenerationAsyncStorage:()=>g});var a={};r.r(a),r.d(a,{POST:()=>u});var n=r(9303),o=r(8716),s=r(670),i=r(7070);let p=new(r(8319)).ZP({apiKey:process.env.OPENAI_API_KEY});async function u(e){try{let{prompt:t,size:r="1024x1024",quality:a="standard"}=await e.json();if(!t)return i.NextResponse.json({error:"Prompt is required"},{status:400});let n=["1024x1024","1792x1024","1024x1792"].includes(r)?r:"1024x1024",o=["standard","hd"].includes(a)?a:"standard";console.log("[Image Generation] Generating image with prompt:",t.substring(0,100)+"..."),console.log("[Image Generation] Size:",n,"Quality:",o);let s=await p.images.generate({model:"dall-e-3",prompt:t,n:1,size:n,quality:o,response_format:"url",style:"vivid"}),u=s.data[0]?.url;if(!u)return console.error("[Image Generation] No image URL returned from OpenAI"),i.NextResponse.json({error:"Failed to generate image - no URL returned"},{status:500});return console.log("[Image Generation] Successfully generated image"),i.NextResponse.json({imageUrl:u,prompt:t,size:n,quality:o,revised_prompt:s.data[0]?.revised_prompt})}catch(e){if(console.error("[Image Generation] Error:",e),e instanceof Error){if(e.message.includes("content_policy_violation"))return i.NextResponse.json({error:"Image generation failed: Content policy violation. Please try a different prompt."},{status:400});if(e.message.includes("safety_system"))return i.NextResponse.json({error:"Image generation failed: Safety system rejection. Please try a different prompt."},{status:400})}return i.NextResponse.json({error:"Failed to generate image"},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/image-generation/route",pathname:"/api/image-generation",filename:"route",bundlePath:"app/api/image-generation/route"},resolvedPagePath:"/Users/haoyu/development/HaoGPT/haogpt-web/src/app/api/image-generation/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:g,serverHooks:m}=l,c="/api/image-generation/route";function f(){return(0,s.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:g})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[948,972,319],()=>r(9224));module.exports=a})();